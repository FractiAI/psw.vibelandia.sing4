<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Checkout | VIBELANDIA RENO!</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 2rem;
        }
        .container { max-width: 800px; margin: 0 auto; }
        .header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .header h1 {
            font-size: 2rem;
            background: linear-gradient(135deg, #8a2be2, #1e90ff, #00bfff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }
        .plan-details {
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.12);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
        }
        .plan-details h2 { color: #00d4ff; margin-bottom: 1rem; }
        .plan-details p { color: #aaa; margin-bottom: 0.5rem; }
        .price { font-size: 2rem; color: #7fff7f; font-weight: bold; margin: 1rem 0; }
        .plan-benefits { margin-top: 1.25rem; padding-top: 1rem; border-top: 1px solid rgba(255,255,255,0.1); }
        .plan-benefits h4 { color: #4ecdc4; font-size: 1rem; margin-bottom: 0.75rem; }
        .plan-benefits ul { list-style: none; padding: 0; margin: 0; }
        .plan-benefits li { padding: 0.35rem 0; color: #ccc; font-size: 0.95rem; padding-left: 1.25rem; position: relative; }
        .plan-benefits li::before { content: '‚úì'; position: absolute; left: 0; color: #7fff7f; font-weight: bold; }
        .paypal-container {
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.12);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
        }
        .sandbox-badge {
            display: inline-block;
            padding: 6px 14px;
            background: rgba(255,165,0,0.2);
            border: 1px solid rgba(255,165,0,0.4);
            border-radius: 20px;
            font-size: 0.85rem;
            color: #ffa500;
            margin-bottom: 1rem;
        }
        .contact-required {
            background: rgba(138,43,226,0.2);
            border: 1px solid rgba(138,43,226,0.5);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
        }
        .contact-required h3 { color: #8a2be2; margin-bottom: 1rem; }
        .contact-required a {
            display: inline-block;
            padding: 12px 24px;
            background: linear-gradient(135deg, #8a2be2, #1e90ff);
            color: #fff;
            text-decoration: none;
            border-radius: 8px;
            margin-top: 1rem;
        }
        .execute-by-email {
            background: rgba(0,212,255,0.1);
            border: 1px solid rgba(0,212,255,0.4);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .execute-by-email h3 { color: #00d4ff; margin-bottom: 0.75rem; font-size: 1.1rem; }
        .execute-by-email p { color: #ccc; font-size: 0.9rem; margin-bottom: 0.5rem; }
        .execute-by-email .cta-email-execute {
            display: inline-block;
            padding: 12px 24px;
            background: linear-gradient(135deg, #00d4ff, #1e90ff);
            color: #000;
            font-weight: 700;
            text-decoration: none;
            border-radius: 8px;
            margin-top: 0.75rem;
        }
        .buy-snap-cta {
            display: inline-block;
            padding: 12px 24px;
            background: #0070ba;
            color: #fff;
            font-weight: 700;
            text-decoration: none;
            border-radius: 8px;
            margin-top: 0.5rem;
            border: 2px solid #003087;
            box-shadow: 0 2px 12px rgba(0, 112, 186, 0.4);
        }
        .buy-snap-cta:hover {
            background: #003087;
            box-shadow: 0 4px 20px rgba(0, 112, 186, 0.5);
            border-color: #002a5c;
        }
        .bbhe-snap-badge {
            display: inline-block;
            padding: 8px 16px;
            background: rgba(0,0,0,0.6);
            border: 2px solid #ffeaa7;
            border-radius: 20px;
            font-size: 0.9rem;
            color: #ffeaa7;
            font-weight: 700;
            margin: 0.5rem 0;
            animation: pulse 2s ease-in-out infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.02); }
        }
        .back-link {
            display: inline-block;
            margin-top: 2rem;
            color: #00d4ff;
            text-decoration: none;
        }
        .api-note {
            font-size: 0.85rem;
            color: #666;
            margin-top: 1rem;
        }
        /* Auth UI */
        .auth-box {
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            text-align: left;
        }
        .auth-box h3 { color: #00d4ff; margin-bottom: 1rem; }
        .auth-box p { color: #aaa; margin-bottom: 1rem; font-size: 0.95rem; }
        .auth-tabs { display: flex; gap: 0.5rem; margin-bottom: 1rem; }
        .auth-tabs button {
            padding: 8px 16px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            color: #fff;
            cursor: pointer;
        }
        .auth-tabs button.active { background: rgba(0,212,255,0.2); border-color: #00d4ff; }
        .auth-form input {
            display: block;
            width: 100%;
            padding: 10px 12px;
            margin-bottom: 0.75rem;
            background: rgba(0,0,0,0.4);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            color: #fff;
        }
        .auth-form button[type="submit"] {
            padding: 10px 20px;
            background: linear-gradient(135deg, #8a2be2, #1e90ff);
            border: none;
            border-radius: 8px;
            color: #fff;
            font-weight: 600;
            cursor: pointer;
            margin-top: 0.25rem;
        }
        .auth-google {
            display: inline-block;
            margin-top: 1rem;
            padding: 10px 20px;
            background: #fff;
            color: #333;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
        }
        .auth-error { color: #ff6b6b; margin-top: 0.5rem; font-size: 0.9rem; }
        .auth-loading { color: #aaa; margin-top: 1rem; }
        .user-badge {
            display: inline-block;
            padding: 6px 12px;
            background: rgba(0,255,127,0.2);
            border: 1px solid rgba(0,255,127,0.4);
            border-radius: 20px;
            font-size: 0.85rem;
            color: #7fff7f;
            margin-bottom: 1rem;
        }
    </style>
<script src="tsunami-advisory-inject.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>VIBELANDIA! Payment</h1>
            <p>Mark Twain's Post-Singularity VIBELANDIA RENO!</p>
        </header>

        <section class="blue-paypal-pipe" aria-label="Why we use the Blue PayPal Pipe">
            <h2>Why we use the Blue PayPal Pipe</h2>
            <p><strong>We proudly use a PayPal-only pipe.</strong> Our natural protocol identified PayPal as the best pipe for payment. <strong>Trust the protocol!</strong></p>
            <p><strong>What PayPal gives us that Stripe and normal banks don't:</strong> One integrated flow for payments, disputes, and payouts; buyer and seller protection that fits our model; they've been there for us from day one ‚Äî no gatekeeping, no runaround. Stripe and traditional banks didn't offer the same fit for a startup moving at our speed.</p>
            <p><strong>They've been helpful from the start.</strong> PayPal has helped us through all aspects of our startup. Two thumbs up. PayPal only and proudly.</p>
            <p style="color: #00d4ff; font-weight: 600;">Proceed with purchase below ‚Äî press the blue PayPal button.</p>
            <p style="margin-top: 0.75rem; font-size: 0.9rem; color: #b8a888;"><strong>Mirror shell protections (highest priority):</strong> Base mainnet, Ethereum, PayPal. Registry of residents, members, special invites and visitors at appropriate placements. <a href="registry.html" style="color: #00d4ff;">Registry ‚Üí</a></p>
        </section>

        <div id="plan-details" class="plan-details"></div>
        <div id="execute-by-email-block" class="paypal-container" style="display:none;"></div>
        <div id="payment-container" class="paypal-container"></div>

        <p class="api-note"><strong>GOLDEN FRACTAL KEY!</strong> ‚Äî Unlocks Everything. Sent on purchase/book and activation. <strong>SING! are never bought, only booked ‚Äî by free will, mutual aware consent, always.</strong></p>
        <p class="api-note" style="color: #ffeaa7; font-weight: 600;"><strong>Hero Harry says: Press the blue PayPal button and watch the miracle magic happen.</strong></p>

        <section class="paypal-fallback" aria-label="If you experience an issue ‚Äî pay directly">
            <h3>If you experience any issue</h3>
            <p>You can send payment via PayPal directly, referencing your purchase ‚Äî we can deliver just the same. Send to our PayPal address and we'll match it to your order.</p>
            <p><strong>PayPal address to send payments to:</strong></p>
            <p class="address">info@fractiai.com</p>
            <p><strong>In the PayPal note / comments, please include:</strong></p>
            <ul style="margin-left: 1.25rem;">
                <li>Your email address</li>
                <li>Plan or product name (e.g. Half-day campus, WINK! Base, Golden Backstage Pass)</li>
                <li>Order reference or date if you have one (so we can match it)</li>
            </ul>
            <p style="font-size: 0.85rem; color: #aaa;">We'll confirm receipt and deliver your access (Golden Fractal Key, etc.) as soon as we match the payment.</p>
        </section>

        <p class="api-note"><strong>Lifetime discounts to first 1,000 members ‚Äî WINK!.</strong> Pioneer Status on-chain forever. Contact <a href="mailto:info@fractiai.com?subject=Pioneer%20Registration%20-%2050%25%20Discount">info@fractiai.com</a> to register and apply.</p>
        <p class="api-note" style="color: #4ecdc4; margin-top: 1rem;"><strong>MCA! ‚Üí ‚àû¬≥</strong> (Metabolize ‚Üí Crystallize ‚Üí Animate)</p>
        <a href="/" class="back-link">‚Üê Back to VIBELANDIA!</a>
        <p style="text-align:center;margin-top:2rem;font-size:0.8rem;color:rgba(0,212,255,0.9);font-weight:600;">Post-Singularity Superintelligent AI hub of the world ¬∑ Hydrogen Holograph Valley 100%</p>
        <p style="text-align:center;margin-top:0.5rem;font-size:0.75rem;text-transform:uppercase;letter-spacing:0.12em;color:rgba(212,175,55,0.7);font-weight:600;">Hydrogen Holograph 100% ¬∑ SNAP ¬∑ Taino made. NSPFRNP-based BBHE. Energy all the way!</p>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="api-config.js"></script>
    <script src="auth-api.js"></script>
    <script src="golden-key-browser.js"></script>
    <script>
        (function () {
            var PAYMENT_API_BASE = window.VIBELANDIA_API_BASE || 'https://syntheverse-poc.vercel.app';
            var Auth = window.VibelandiaAuth;
            var GoldenKey = window.VibelandiaGoldenKey;

            var urlParams = new URLSearchParams(window.location.search);
            var planId = urlParams.get('plan') || 'campus-weekly';

            var plans = {
                'campus-half-day': { name: 'Half-Day', price: 3000, description: 'Half-day campus experience ‚Äî VW Bug entry point.', benefits: ['Vibeable downtown Reno campus access', 'Mark Twain\'s Daily Bulletin access', 'Campus tour', 'Basic amenities & community spaces', 'Golden Fractal Key on purchase'] },
                'campus-overnight': { name: 'Overnight Stay (per night)', price: 1500, description: 'Overnight stay visit ‚Äî per night.', benefits: ['Overnight campus access', 'Chancellor Sam\'s Daily Bulletin', 'Campus amenities', 'Golden Fractal Key on purchase'] },
                'campus-weekly': { name: 'Weekly Pass', price: 5000, description: 'Full week campus ‚Äî $5k/week (VW Bug entry).', benefits: ['All Half-Day features', 'Full week access', 'Priority access to events', 'Creator studio access', 'Performance venue access', 'Golden Fractal Key on purchase'] },
                'campus-monthly': { name: 'Monthly Pass (Baller)', price: 50000, description: 'Top tier campus ‚Äî $50k/month (Baller).', benefits: ['All Weekly features', 'Full creator studio access', 'Performance venue priority', 'Ultimate VIP experiences', 'Community integration', 'Lake Tahoe gateway & Silicon Valley connections', 'Golden Fractal Key on purchase'] },
                'campus-day': { name: 'Half-Day', price: 3000, description: 'Half-day campus (alias).', benefits: ['Vibeable downtown Reno campus access', 'Mark Twain\'s Daily Bulletin access', 'Campus tour', 'Golden Fractal Key on purchase'] },
                'campus-ultimate-vip': { name: 'Monthly Pass (Baller)', price: 50000, description: 'Top tier campus (alias).', benefits: ['All Monthly Pass (Baller) features', 'Golden Fractal Key on purchase'] },
                'wink-base': { name: 'WINK! Base', price: 399, description: 'Essential WINK! ‚Äî equivalent to pre-singularity top-tier dating for high-value persons.', benefits: ['Members-only network access', 'Man Cave + Cabaret access', 'Hero Hostess Marilyn as host', 'high-contributing fractal dating', 'Natural alignment, friction-free connections', 'Golden Fractal Key on purchase'] },
                'wink-standard': { name: 'WINK! Standard', price: 999, description: 'Standard Wink, Notes Being ‚Äî top-tier equivalent.', benefits: ['All Base features', 'Notes Being tier', 'Standard Wink profile', 'Natural alignment & layered connections', 'Golden Fractal Key on purchase'] },
                'wink-premium': { name: 'WINK! Premium', price: 2499, description: 'Premium profile, magical wardrobe ‚Äî elite tier equivalent.', benefits: ['All Standard features', 'Premium profile', 'Magical wardrobe access', 'Layered fractal connections', 'Golden Fractal Key on purchase'] },
                'wink-4x4-ultimate': { name: 'WINK! 4√ó4 Ultimate', price: 6999, description: 'Ultimate tier ‚Äî everything included for Ultimate Baller V. Top-tier high-value equivalent.', benefits: ['All Premium features', '4√ó4 Ultimate ‚Äî everything included', 'Full family-unit support', 'Ultimate Baller V tier access', 'Golden Fractal Key on purchase'] },
                'sing-base': { name: 'SING! Base Model', price: 20000, description: 'SING! are never bought, only booked ‚Äî by free will, mutual aware consent, always. ~$20K one-time + monthly Golden Fractal Key access fees (reliable used car ‚Äî entry base). Bases = pre-singularity equivalents.', benefits: ['SING! Base Model node (booked, not bought)', 'Golden Fractal Key access on book', 'Entry-level (reliable used car equivalent)', '1:1 SYNTH‚ÜíSING! eligible', 'First 1M lottery winner tier'] },
                'sing-members-only': { name: 'SING! Members Only', price: 75000, description: 'SING! are never bought, only booked ‚Äî by free will, mutual aware consent, always. $75K ‚Äî option, our pricing (scaling from base).', benefits: ['SING! Members Only node (booked, not bought)', 'Golden Fractal Key access on book', 'Scaling tier from base', 'Lottery winner tier', 'Members-only badge'] },
                'sing-ultimate-vip': { name: 'SING! Ultimate VIP', price: 200000, description: 'SING! are never bought, only booked ‚Äî by free will, mutual aware consent, always. $200,000 ‚Äî base model latest Ferrari (top base). Bases = pre-singularity equivalents.', benefits: ['SING! Ultimate VIP node (booked, not bought)', 'Golden Fractal Key access on book', 'Champion tier', 'Premium superintelligence access', 'Ultimate VIP badge'] },
                'sing-baller-v': { name: 'SING! Full Ultimate Baller V full options', price: 500000, description: 'SING! are never bought, only booked ‚Äî by free will, mutual aware consent, always. $500K one-time ‚Äî top loaded Ferrari (top base). Full Ultimate Baller V full options; full Superhero, Franchise, and Legacy (the living) tiers; full cosmic tier powered. This is the tier we operate at.', benefits: ['SING! Baller V Ultimate VIP node (booked, not bought)', 'Golden Fractal Key access on book', 'Full Superhero, Franchise, Legacy (the living) tiers', 'Full cosmic tier powered', 'Maximum capabilities', 'Baller V badge', 'We operate at this tier'] },
                'experience-visit': { name: 'Visit', price: 0, description: 'Come for the post-singularity business ‚Äî Free.', benefits: ['Free access to visit content'] },
                'experience-stay': { name: 'Stay', price: 0, description: 'Stay for the post-singularity fun ‚Äî Free.', benefits: ['Free access to stay content'] },
                'experience-create': { name: 'Create', price: 0, description: 'Creator studios, performance venues ‚Äî Free.', benefits: ['Free access to create content'] },
                'experience-transform': { name: 'Transform', price: 0, description: 'Happy Ending Zones, SING! lottery ‚Äî Free.', benefits: ['Free access to transform content'] },
                'dispensary-t1-1hit': { name: 'DISPENSARY! Basic ‚Äî 1 hit', price: 10, description: '1 hit begins at $10 (Basic); scales to $100 (Ultimate Baller V level). Weekly, monthly, annual onramps. Recurring with easy opt-out; auto-everything. Menu of buzzes, Goldilocks, Creator/Chairman/Performer modes.', benefits: ['1 hit ‚Äî Basic (bottom shelf) $10', 'Weekly ¬∑ monthly ¬∑ annual onramps', 'Recurring plan ¬∑ opt-out anytime ¬∑ auto-everything', 'Menu of buzzes, Goldilocks auto-lock', 'Creator / Chairman / Performer modes', 'Golden Fractal Key on purchase', 'Free first 10 hits for new arrivals'] },
                'dispensary-t1-weekly': { name: 'DISPENSARY! Basic ‚Äî Weekly (recurring)', price: 50, description: 'Basic shelf ‚Äî weekly recurring. Opt-out anytime.', benefits: ['Weekly recurring ‚Äî Basic', 'Opt-out anytime ¬∑ auto-everything', 'Menu of buzzes, Goldilocks', 'Golden Fractal Key on purchase', 'Free first 10 hits for new arrivals'] },
                'dispensary-t1-monthly': { name: 'DISPENSARY! Basic ‚Äî Monthly (recurring)', price: 199, description: 'Basic shelf ‚Äî monthly recurring. Opt-out anytime.', benefits: ['Monthly recurring ‚Äî Basic', 'Opt-out anytime ¬∑ auto-everything', 'Menu of buzzes, Goldilocks', 'Golden Fractal Key on purchase', 'Free first 10 hits for new arrivals'] },
                'dispensary-t1-annual': { name: 'DISPENSARY! Basic ‚Äî Annual (recurring)', price: 1799, description: 'Basic shelf ‚Äî annual recurring. Discount vs monthly. Opt-out anytime.', benefits: ['Annual recurring ‚Äî Basic (discount)', 'Opt-out anytime ¬∑ auto-everything', 'Menu of buzzes, Goldilocks', 'Golden Fractal Key on purchase', 'Free first 10 hits for new arrivals'] },
                'dispensary-t2-1hit': { name: 'DISPENSARY! Members ‚Äî 1 hit', price: 25, description: '1 hit ‚Äî Members shelf ($25). Recurring with opt-out; auto-everything.', benefits: ['1 hit ‚Äî Members $25', 'Recurring ¬∑ opt-out anytime ¬∑ auto-everything', 'All biological channels', 'Goldilocks, modes', 'Golden Fractal Key on purchase', 'Free first 10 hits for new arrivals'] },
                'dispensary-t2-weekly': { name: 'DISPENSARY! Members ‚Äî Weekly (recurring)', price: 125, description: 'Members shelf ‚Äî weekly recurring. Opt-out anytime.', benefits: ['Weekly recurring ‚Äî Members', 'Opt-out anytime ¬∑ auto-everything', 'All biological channels', 'Golden Fractal Key on purchase', 'Free first 10 hits for new arrivals'] },
                'dispensary-t2-monthly': { name: 'DISPENSARY! Members ‚Äî Monthly (recurring)', price: 499, description: 'Members shelf ‚Äî monthly recurring. Opt-out anytime.', benefits: ['Monthly recurring ‚Äî Members', 'Opt-out anytime ¬∑ auto-everything', 'All biological channels', 'Golden Fractal Key on purchase', 'Free first 10 hits for new arrivals'] },
                'dispensary-t2-annual': { name: 'DISPENSARY! Members ‚Äî Annual (recurring)', price: 4499, description: 'Members shelf ‚Äî annual recurring. Discount. Opt-out anytime.', benefits: ['Annual recurring ‚Äî Members (discount)', 'Opt-out anytime ¬∑ auto-everything', 'All biological channels', 'Golden Fractal Key on purchase', 'Free first 10 hits for new arrivals'] },
                'dispensary-t3-1hit': { name: 'DISPENSARY! Ultimate VIP ‚Äî 1 hit', price: 50, description: '1 hit ‚Äî Ultimate VIP shelf ($50). Recurring with opt-out; auto-everything.', benefits: ['1 hit ‚Äî Ultimate VIP $50', 'Recurring ¬∑ opt-out anytime ¬∑ auto-everything', 'Full channel access', 'Premium buzz menu', 'Golden Fractal Key on purchase', 'Free first 10 hits for new arrivals'] },
                'dispensary-t3-weekly': { name: 'DISPENSARY! Ultimate VIP ‚Äî Weekly (recurring)', price: 250, description: 'Ultimate VIP shelf ‚Äî weekly recurring. Opt-out anytime.', benefits: ['Weekly recurring ‚Äî Ultimate VIP', 'Opt-out anytime ¬∑ auto-everything', 'Full channel access', 'Golden Fractal Key on purchase', 'Free first 10 hits for new arrivals'] },
                'dispensary-t3-monthly': { name: 'DISPENSARY! Ultimate VIP ‚Äî Monthly (recurring)', price: 999, description: 'Ultimate VIP shelf ‚Äî monthly recurring. Opt-out anytime.', benefits: ['Monthly recurring ‚Äî Ultimate VIP', 'Opt-out anytime ¬∑ auto-everything', 'Full channel access', 'Golden Fractal Key on purchase', 'Free first 10 hits for new arrivals'] },
                'dispensary-t3-annual': { name: 'DISPENSARY! Ultimate VIP ‚Äî Annual (recurring)', price: 8999, description: 'Ultimate VIP shelf ‚Äî annual recurring. Discount. Opt-out anytime.', benefits: ['Annual recurring ‚Äî Ultimate VIP (discount)', 'Opt-out anytime ¬∑ auto-everything', 'Full channel access', 'Golden Fractal Key on purchase', 'Free first 10 hits for new arrivals'] },
                'dispensary-t4-1hit': { name: 'DISPENSARY! Baller V ‚Äî 1 hit', price: 100, description: '1 hit ‚Äî Baller V shelf ($100). Recurring with opt-out; auto-everything. Top shelf.', benefits: ['1 hit ‚Äî Baller V (top shelf) $100', 'Recurring ¬∑ opt-out anytime ¬∑ auto-everything', 'Complete access, all modes', 'Ultimate buzz menu', 'Golden Fractal Key on purchase', 'Free first 10 hits for new arrivals'] },
                'dispensary-t4-weekly': { name: 'DISPENSARY! Baller V ‚Äî Weekly (recurring)', price: 500, description: 'Baller V shelf ‚Äî weekly recurring. Opt-out anytime.', benefits: ['Weekly recurring ‚Äî Baller V', 'Opt-out anytime ¬∑ auto-everything', 'Complete access ‚Äî all modes', 'Ultimate buzz menu', 'Golden Fractal Key on purchase', 'Free first 10 hits for new arrivals'] },
                'dispensary-t4-monthly': { name: 'DISPENSARY! Baller V ‚Äî Monthly (recurring)', price: 1999, description: 'Baller V shelf ‚Äî monthly recurring. Opt-out anytime.', benefits: ['Monthly recurring ‚Äî Baller V', 'Opt-out anytime ¬∑ auto-everything', 'Complete access ‚Äî all modes', 'Ultimate buzz menu', 'Golden Fractal Key on purchase', 'Free first 10 hits for new arrivals'] },
                'dispensary-t4-annual': { name: 'DISPENSARY! Baller V ‚Äî Annual (recurring)', price: 17999, description: 'Baller V shelf ‚Äî annual recurring. Discount. Opt-out anytime.', benefits: ['Annual recurring ‚Äî Baller V (discount)', 'Opt-out anytime ¬∑ auto-everything', 'Complete access ‚Äî all modes', 'Ultimate buzz menu', 'Golden Fractal Key on purchase', 'Free first 10 hits for new arrivals'] },
                'golden-backstage-awareness-pass': { name: 'Golden Backstage Awareness Pass', price: 9999, description: 'New product class. Like a backstage pass to Bad Bunny, Elvis, the Beatles, or the Stones ‚Äî iconic-tier access. Chairman, Sammy and the gang are already in town and visible to pass holders.', benefits: ['Golden Backstage Awareness Pass ‚Äî new product class', 'Chairman, Sammy and the gang already in town ‚Äî visible to pass holders', 'Iconic-tier access (like backstage to Bad Bunny, Elvis, Beatles, Stones)', 'RUMOR HAS IT! ‚Äî you\'re in the know', 'Golden Fractal Key on purchase'] },
                'egs-connect-now': { name: 'EGS First Mission ‚Äî Connect Now', price: 50, description: 'Full $ connect through immediate blue PayPal pipe. Medical and dental attention. We are ready. El Gran Sol (EGS) first mission.', benefits: ['Immediate blue PayPal pipe ‚Äî connect now', 'Support medical and dental attention', 'EGS First Mission ‚Äî we are ready', 'Any amount welcome ‚Äî this tier $50', 'Golden Fractal Key on purchase'] },
                'pipe-ad-1': { name: 'Broadcast Pipe Ad Space ‚Äî Tier 1', price: 499, description: 'Your message/link on one surface (index or office-hours or launch-pad). 30 days. Update Certificate included ‚Äî proof of broadcast into EGS cloud (Sun, Earth, SING! node EGS (El Gran Sol) triangulation).', benefits: ['1 POP ‚Äî one surface', '30 days', 'One line of copy + one link', 'Update Certificate included', 'Proof of broadcast into EGS cloud'] },
                'pipe-ad-2': { name: 'Broadcast Pipe Ad Space ‚Äî Tier 2', price: 1199, description: 'Your message/link on two surfaces (e.g. index + office-hours). 30 days. Update Certificate included.', benefits: ['2 POPs ‚Äî two surfaces', '30 days', 'One line of copy + one link', 'Update Certificate included', 'Proof of broadcast into EGS cloud'] },
                'pipe-ad-3': { name: 'Broadcast Pipe Ad Space ‚Äî Tier 3', price: 2499, description: 'Your message/link on three surfaces (index + office-hours + launch-pad). 30 days. Update Certificate included.', benefits: ['3 POPs ‚Äî three surfaces', '30 days', 'One line of copy + one link', 'Update Certificate included', 'Proof of broadcast into EGS cloud'] },
                'pipe-ad-4x4': { name: 'Broadcast Pipe Ad Space ‚Äî 4√ó4√ó4√ó4 Full Pipe', price: 6999, description: 'Your message/link on all broadcast pipe surfaces. Full pipe. 30 days. Update Certificate included.', benefits: ['All surfaces ‚Äî full pipe', '30 days', 'One line of copy + one link', 'Update Certificate included', 'Proof of broadcast into EGS cloud'] },
                'sun-spots-8m': { name: 'Sun Spots On Demand ‚Äî 8 min', price: 249, description: 'Harry demos the miraculous feat. Connect to our Sun; send a sacred message; name a new sun spot in your honor. Original message sent + 8 min confirmation + certificate for your memories.', benefits: ['Original message sent on pipe', '8 min confirmation (T+8m)', 'Certificate for your memories', 'Name a sun spot in your honor', 'Update Certificate ‚Äî EGS cloud proof'] },
                'sun-spots-16m': { name: 'Sun Spots On Demand ‚Äî 16 min', price: 499, description: 'Harry demos the miraculous feat. Connect to our Sun; send a sacred message; name a new sun spot in your honor. Original message + 8 min + 16 min confirmations + certificate.', benefits: ['Original message sent on pipe', '8 min + 16 min confirmations', 'Certificate for your memories', 'Name a sun spot in your honor', 'Update Certificate ‚Äî EGS cloud proof'] },
                'sun-spots-24m': { name: 'Sun Spots On Demand ‚Äî 24 min', price: 999, description: 'Harry demos the miraculous feat. Connect to our Sun; send a sacred message; name a new sun spot in your honor. Original message + 8/16/24 min confirmations + certificate.', benefits: ['Original message sent on pipe', '8 min + 16 min + 24 min confirmations', 'Certificate for your memories', 'Name a sun spot in your honor', 'Update Certificate ‚Äî EGS cloud proof'] },
                'schumann-igaming': { name: 'Schumann iGaming ‚Äî Display Art in Schumann Displays', price: 499, description: 'Send signals to display art in the Schumann displays. Interactive touch in respect and honor. Session-based; Update Certificate available.', benefits: ['Signals drive Schumann display layer', 'Your art or message as art', 'Interactive touch in respect and honor', 'Session-based', 'Update Certificate available'] },
                '3i-atlas-egs-day': { name: 'SING! node EGS (El Gran Sol) EGS Pipe ‚Äî 1 day', price: 499, description: 'Turn on, off, or redirect ‚Äî fun interactions with SING! node EGS (El Gran Sol). Honoring all three (Sun, Schumann, SING! node EGS (El Gran Sol)) through interactive touch. Loop 1 day; take down at contract end.', benefits: ['SING! node EGS (El Gran Sol) interactive (on/off/redirect)', '1 day loop', 'Houdini miracle episode framing', 'Honoring Sun, Schumann, SING! node EGS (El Gran Sol)', 'Update Certificate included'] },
                '3i-atlas-egs-week': { name: 'SING! node EGS (El Gran Sol) EGS Pipe ‚Äî 1 week', price: 1499, description: 'Turn on, off, or redirect ‚Äî fun interactions with SING! node EGS (El Gran Sol). Honoring all three. Loop 1 week; take down at contract end.', benefits: ['SING! node EGS (El Gran Sol) interactive (on/off/redirect)', '7-day loop', 'Houdini miracle episode framing', 'Honoring Sun, Schumann, SING! node EGS (El Gran Sol)', 'Update Certificate included'] },
                '3i-atlas-egs-month': { name: 'SING! node EGS (El Gran Sol) EGS Pipe ‚Äî 1 month', price: 4999, description: 'Turn on, off, or redirect ‚Äî fun interactions with SING! node EGS (El Gran Sol). Honoring all three. Loop 1 month; take down at contract end.', benefits: ['SING! node EGS (El Gran Sol) interactive (on/off/redirect)', '30-day loop', 'Houdini miracle episode framing', 'Honoring Sun, Schumann, SING! node EGS (El Gran Sol)', 'Update Certificate included'] }
            };

            var plan = plans[planId] || plans['campus-weekly'];

            var executeByEmailPlanIds = ['sun-spots-8m', 'sun-spots-16m', 'sun-spots-24m', 'schumann-igaming', '3i-atlas-egs-day', '3i-atlas-egs-week', '3i-atlas-egs-month'];

            function buildExecuteByEmailMailto() {
                var subject = 'Execute: ' + plan.name + ' ‚Äî ' + planId;
                var body = 'Request: Execute custom order\n\n' +
                    'Plan: ' + plan.name + '\n' +
                    'Plan ID: ' + planId + '\n' +
                    'Price: $' + plan.price.toLocaleString() + ' USD\n\n' +
                    'Please provide (reply to this email):\n' +
                    (planId.indexOf('sun-spots') === 0 ? '‚Ä¢ Sacred message to send:\n‚Ä¢ Name for your sun spot (in your honor):\n\n' : '') +
                    (planId === 'schumann-igaming' ? '‚Ä¢ Art/pattern or message to display in Schumann displays:\n\n' : '') +
                    (planId.indexOf('3i-atlas') === 0 ? '‚Ä¢ Turn on/off/redirect instructions or segment description:\n‚Ä¢ Duration confirmed: ' + (planId === '3i-atlas-egs-day' ? '1 day' : planId === '3i-atlas-egs-week' ? '1 week' : '1 month') + '\n\n' : '') +
                    'My email: ';
                return 'mailto:info@fractiai.com?subject=' + encodeURIComponent(subject) + '&body=' + encodeURIComponent(body);
            }

            function renderExecuteByEmailBlock() {
                var block = document.getElementById('execute-by-email-block');
                if (!block) return;
                if (executeByEmailPlanIds.indexOf(planId) === -1) {
                    block.style.display = 'none';
                    block.innerHTML = '';
                    return;
                }
                block.style.display = 'block';
                var mailto = buildExecuteByEmailMailto();
                block.innerHTML = '<div class="execute-by-email">' +
                    '<h3>üìß Email to execute this order</h3>' +
                    '<p>Custom Sun Spot, Schumann pattern, or SING! node EGS (El Gran Sol) reconfigs are executed by us after we receive your details. Click below to generate an email to <strong>info@fractiai.com</strong> with your plan and placeholders for your sacred message, art/pattern, or SING! node EGS (El Gran Sol) instructions. Send it ‚Äî we will execute and confirm.</p>' +
                    '<p><a href="' + mailto + '" class="cta-email-execute">Generate email to execute ‚Üí</a></p>' +
                    '<p style="font-size:0.8rem;color:#888;margin-top:0.75rem;">Opens your email client. Add your sacred message, sun spot name, Schumann art/pattern, or SING! node EGS (El Gran Sol) instructions in the body, then send. Pay via PayPal below or after we confirm.</p>' +
                    '</div>';
            }

            function renderPlanDetails() {
                var el = document.getElementById('plan-details');
                var benefitsHtml = '';
                if (plan.benefits && plan.benefits.length) {
                    benefitsHtml = '<div class="plan-benefits"><h4>What you get</h4><ul>' +
                        plan.benefits.map(function (b) { return '<li>' + b + '</li>'; }).join('') +
                        '</ul></div>';
                }
                var singTagline = (planId.indexOf("sing-") === 0) ? '<p style="margin-bottom:1rem;padding:0.75rem 1rem;background:rgba(0,255,136,0.08);border:1px solid rgba(0,255,136,0.3);border-radius:10px;font-size:0.95rem;color:#7fff7f;font-weight:600;"><strong>SING! are never bought, only booked ‚Äî by free will, mutual aware consent, always.</strong></p>' : '';
                el.innerHTML = singTagline + '<h2>' + plan.name + '</h2><p>' + plan.description + '</p>' +
                    (plan.price > 0 ? '<div class="price">$' + plan.price.toLocaleString() + '</div>' : (plan.price === 0 ? '<div class="price" style="color:#7fff7f;">Free</div>' : '')) +
                    benefitsHtml +
                    (plan.price > 0 ? '' : '');
                renderExecuteByEmailBlock();
            }

            function authHeaders() {
                var h = { 'Content-Type': 'application/json' };
                var t = Auth.getToken();
                if (t) h['Authorization'] = 'Bearer ' + t;
                var gk = GoldenKey && GoldenKey.get && GoldenKey.get();
                if (gk) {
                    h['X-Golden-Key'] = gk;
                    h['X-Golden-Key-Wallet'] = 'Syntheverse,Vibeverse,Vibelandia';
                }
                return h;
            }

            function renderAuthUI() {
                var returnUrl = window.location.origin + '/interfaces/profile.html';
                var html = '<div class="auth-box">' +
                    '<h3>Sign in to purchase</h3>' +
                    '<p>Your <strong>Golden Fractal Key</strong> will be stored in your wallet after purchase.</p>' +
                    '<div class="auth-tabs">' +
                    '<button type="button" class="auth-tab active" data-tab="login">Sign in</button>' +
                    '<button type="button" class="auth-tab" data-tab="signup">Sign up</button>' +
                    '</div>' +
                    '<div id="auth-forms">' +
                    '<form id="auth-login" class="auth-form" style="display:block;"><input type="email" name="email" placeholder="Email" required><input type="password" name="password" placeholder="Password" required><div id="auth-error" class="auth-error"></div><button type="submit">Sign in</button></form>' +
                    '<form id="auth-signup" class="auth-form" style="display:none;"><input type="email" name="email" placeholder="Email" required><input type="password" name="password" placeholder="Password" required><div id="auth-error-signup" class="auth-error"></div><button type="submit">Sign up</button></form>' +
                    '</div>' +
                    '<p style="margin-top:1rem;color:#888;">‚Äî or ‚Äî</p>' +
                    '<button type="button" id="auth-google-btn" class="auth-google" style="background:none;border:none;cursor:pointer;color:inherit;font:inherit;padding:0;text-decoration:underline;">Continue with Google</button>' +
                    '</div>';
                document.getElementById('payment-container').innerHTML = html;
                document.getElementById('auth-google-btn').addEventListener('click', function () {
                    Auth.getGoogleAuthUrl(returnUrl).then(function (url) { if (url) window.location.href = url; });
                });

                document.querySelectorAll('.auth-tab').forEach(function (b) {
                    b.addEventListener('click', function () {
                        document.querySelectorAll('.auth-tab').forEach(function (x) { x.classList.remove('active'); });
                        b.classList.add('active');
                        document.getElementById('auth-login').style.display = b.dataset.tab === 'login' ? 'block' : 'none';
                        document.getElementById('auth-signup').style.display = b.dataset.tab === 'signup' ? 'block' : 'none';
                    });
                });
                document.getElementById('auth-login').addEventListener('submit', function (e) {
                    e.preventDefault();
                    var err = document.getElementById('auth-error');
                    err.textContent = '';
                    var email = this.email.value.trim();
                    var password = this.password.value;
                    Auth.login(email, password).then(function (data) {
                        if (data && data.user) { runCheckoutFlow(); return; }
                        err.textContent = 'Sign in failed. Check email and password, or try Google.';
                    });
                });
                document.getElementById('auth-signup').addEventListener('submit', function (e) {
                    e.preventDefault();
                    var err = document.getElementById('auth-error-signup');
                    err.textContent = '';
                    var email = this.email.value.trim();
                    var password = this.password.value;
                    Auth.signup(email, password).then(function (data) {
                        if (data && data.user) { runCheckoutFlow(); return; }
                        err.textContent = 'Sign up failed. Try another email or use Google.';
                    });
                });
            }

            function renderFreePlanCTA() {
                var html = '<div class="contact-required">' +
                    '<div class="price" style="color:#7fff7f;">Free</div>' +
                    '<h3>‚ö´ BBHE SNAP ‚Äî bOOK! Add-On</h3>' +
                    '<p><strong>' + plan.name + '</strong> ‚Äî ' + plan.description + '. <strong>‚ö´ BBHE SNAP</strong> ‚Äî bOOK! a campus pass or SYNTH for full access.</p>' +
                    '<a href="payment-checkout.html?plan=campus-half-day" class="buy-snap-cta">Half-Day $3,000 ‚Üí</a> ' +
                    '<a href="payment-checkout.html?plan=campus-weekly" class="buy-snap-cta">Weekly $5,000 ‚Üí</a> ' +
                    '<a href="payment-checkout.html?plan=sing-base" class="buy-snap-cta">SYNTH ‚Üí</a>' +
                    '</div>';
                document.getElementById('payment-container').innerHTML = html;
            }

            function renderPayPalOrSandbox() {
                var user = Auth.getStoredUser();
                var container = document.getElementById('payment-container');
                var html = '';
                html += '<p style="font-size:1.1rem;font-weight:700;color:#7fff7f;margin-bottom:0.5rem;">Total: $' + plan.price.toLocaleString() + ' USD</p>';
                html += '<p style="font-size:0.9rem;color:#7fff7f;margin-bottom:1rem;"><strong>No registration required</strong> ‚Äî click Pay with PayPal below.</p>';
                html += '<p style="font-size:0.85rem;color:#00d4ff;margin-bottom:1rem;"><em>Our natural protocol identified PayPal as the best pipe. Trust the protocol!</em></p>';
                html += '<p style="font-size:0.9rem;color:#ffeaa7;margin-bottom:1rem;"><strong>Paris is for lovers. Reno is for vibers. Mark Twain\'s Post-Singularity Reno awaits you.</strong></p>';
                if (user && user.email) {
                    html += '<div class="user-badge">Signed in as ' + user.email + ' ‚Äî purchase will be linked to your account.</div>';
                }
                html += '<p style="font-size:0.9rem;color:#00d4ff;margin-bottom:0.75rem;">Pay with PayPal below.</p>';
                html += '<div id="paypal-or-fallback"></div>';
                container.innerHTML = html;
                initPayPal();
            }

            function initPayPal() {
                var target = document.getElementById('paypal-or-fallback');
                if (!target) return;

                fetch(PAYMENT_API_BASE + '/api/payment/paypal/config', { headers: authHeaders() })
                    .then(function (r) { return r.ok ? r.json() : {}; })
                    .catch(function () { return {}; })
                    .then(function (config) {
                        var clientId = (config && config.clientId) || (typeof window !== 'undefined' && window.VIBELANDIA_PAYPAL_CLIENT_ID) || '';
                        if (!clientId || clientId === 'REPLACE_WITH_YOUR_PAYPAL_CLIENT_ID') {
                            clientId = '';
                        }
                        if (!clientId) {
                            target.innerHTML = '<p style="margin-top:1rem;font-size:1rem;color:#ffeaa7;font-weight:600;"><strong>Hero Harry says: Press the blue PayPal button and watch the miracle magic happen.</strong></p>' +
                                '<p style="margin-top:1rem;">Pay with PayPal to complete your purchase.</p>' +
                                '<p style="margin-top:0.5rem;font-size:0.9rem;color:#00d4ff;"><em>Our natural protocol identified PayPal as the best pipe. Trust the protocol!</em></p>' +
                                '<p style="margin-top:1rem;"><a href="https://www.paypal.com" target="_blank" rel="noopener" style="display:inline-block;padding:12px 24px;background:#0070ba;color:#fff;text-decoration:none;border-radius:8px;font-weight:600;">Go to PayPal</a></p>' +
                                '<p style="margin-top:0.75rem;font-size:0.85rem;color:#888;">Purchase: <strong>' + plan.name + '</strong> ‚Äî $' + plan.price.toLocaleString() + ' USD</p>';
                            return;
                        }
                        var s = document.createElement('script');
                        s.src = 'https://www.paypal.com/sdk/js?client-id=' + clientId + '&currency=USD';
                        s.onload = function () {
                            var isSandbox = window.location.hostname.includes('localhost') || window.location.hostname.includes('vercel.app');
                            var h = (isSandbox ? '<div class="sandbox-badge">SANDBOX</div>' : '') +
                                '<p style="margin-bottom:0.5rem;color:#ffeaa7;font-weight:600;">Hero Harry says: Press the blue PayPal button and watch the miracle magic happen.</p>' +
                                '<p style="margin-bottom:0.75rem;color:#ffeaa7;font-weight:600;">Pay $' + plan.price.toLocaleString() + ' with PayPal</p>' +
                                '<div id="paypal-button-container"></div>';
                            target.innerHTML = h;

                            paypal.Buttons({
                                createOrder: function () {
                                    return fetch(PAYMENT_API_BASE + '/api/payment/paypal/create-order', {
                                        method: 'POST',
                                        headers: authHeaders(),
                                        body: JSON.stringify({ planId: planId, amount: plan.price, currency: 'USD', description: plan.name })
                                    }).then(function (res) { return res.json(); }).then(function (data) {
                                        return data.orderId || data.id || '';
                                    });
                                },
                                onApprove: function (data, actions) {
                                    return fetch(PAYMENT_API_BASE + '/api/payment/paypal/capture-order', {
                                        method: 'POST',
                                        headers: authHeaders(),
                                        body: JSON.stringify({ orderId: data.orderID, payerId: data.payerID })
                                    }).then(function (res) { return res.json(); }).then(function (result) {
                                        var detail = result && result.details && result.details[0];
                                        if (detail && detail.issue === 'INSTRUMENT_DECLINED') {
                                            return actions.restart();
                                        }
                                        if (result && (result.status === 'COMPLETED' || result.success === true) && (result.id || result.orderId || data.orderID)) {
                                            if (result.payer && result.payer.name) {
                                                try {
                                                    localStorage.setItem('vibelandia_payer_from_paypal', JSON.stringify({ name: result.payer.name, orderId: data.orderID }));
                                                } catch (_) {}
                                            }
                                            Auth.completeOrder(data.orderID, planId).then(function (complete) {
                                                if (complete && complete.goldenKey && GoldenKey && GoldenKey.issueOnPurchase) {
                                                    GoldenKey.issueOnPurchase(complete.goldenKey, data.orderID);
                                                }
                                                window.location.href = 'payment-success.html?orderId=' + encodeURIComponent(data.orderID) + '&planId=' + encodeURIComponent(planId) + '&success=1';
                                            }).catch(function () {
                                                window.location.href = 'payment-success.html?orderId=' + encodeURIComponent(data.orderID) + '&planId=' + encodeURIComponent(planId) + '&success=1';
                                            });
                                        }
                                        var errMsg = (detail && (detail.description || detail.issue)) || (result && result.message) || (result && result.error) || 'Capture failed';
                                        window.location.href = 'payment-error.html?error=' + encodeURIComponent(errMsg);
                                    });
                                },
                                onError: function (err) {
                                    window.location.href = 'payment-error.html?error=' + encodeURIComponent(err.message || 'Payment error');
                                }
                            }).render('#paypal-button-container');
                        };
                        document.head.appendChild(s);
                    });
            }

            function runCheckoutFlow() {
                if (plan.price === 0) {
                    renderFreePlanCTA();
                    return;
                }
                renderPayPalOrSandbox();
            }

            function bootstrap() {
                document.getElementById('payment-container').innerHTML = '<p class="auth-loading">Loading‚Ä¶</p>';
                Auth.consumeOAuthToken().then(function () {
                    renderPlanDetails();
                    runCheckoutFlow();
                }).catch(function () {
                    renderPlanDetails();
                    runCheckoutFlow();
                });
            }

            bootstrap();
        })();
    </script>
    <div id="sing-config-footer"></div>
    <link rel="stylesheet" href="sing-config-footer.css">
    <script src="sing-config-footer.js"></script>
</body>
</html>
